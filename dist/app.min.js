/*! FB_PAGE_FAV Assignment by LS. 2017-04-18 */
"use strict";!function(a){var b=function(){this.topics={},this.subUid=-1};b.prototype.listenTo=function(a,b){this.topics[a]||(this.topics[a]=[]);var c=(++this.subUid).toString();return this.topics[a].push({token:c,func:b}),c},b.prototype.on=function(a,b,c){if(!b.topics||!b.topics[a])return!1;for(var d=b.topics[a],e=d?d.length:0;e--;)d[e].func(b,c);return!0},b.prototype.dontListen=function(a){for(var b in this.topics)if(this.topics[b])for(var c=0,d=this.topics[b].length;d>c;c++)if(this.topics[b][c].token===a)return this.topics[b].splice(c,1),a;return!1},a.listenerEvents=b}(app),function(a){var b={},c=function(a){return null==a?String(a):b[toString.call(a)]||"object"},d=function(a){return null!=a&&a==a.window},e=function(a){return"[object Function]"===toString.call(a)},f=Array.isArray||function(a){return"array"===c(a)},g=function(a){if(!a||"object"!==c(a)||a.nodeType||d(a))return!1;try{if(a.constructor&&!hasOwn.call(a,"constructor")&&!hasOwn.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var e;for(e in a);return void 0===e||hasOwn.call(a,e)};a.extend=function(){var b,c,d,h,i,j,k=arguments[0]||{},l=1,m=arguments.length,n=!1;for("boolean"==typeof k&&(n=k,k=arguments[1]||{},l=2),"object"==typeof k||e(k)||(k={}),m===l&&(k=this,--l);m>l;l++)if(null!=(b=arguments[l]))for(c in b)d=k[c],h=b[c],k!==h&&(n&&h&&(g(h)||(i=f(h)))?(i?(i=!1,j=d&&f(d)?d:[]):j=d&&g(d)?d:{},k[c]=a.extend(n,j,h)):void 0!==h&&(k[c]=h));return k}}(app),function(a){a.isFunction=function(a){return"function"==typeof a},a.extendClass=function(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a},a.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return JSON.stringify(a)===JSON.stringify({})},a.addEvent=function(b,c,d,e){var f,g=b.$el;!function(a){f=a.matchesSelector||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector}(document.documentElement),b.events||(b.events={}),b.events[d]||(b.events[d]={}),b.events[d][c]=function(b){element=a.isChild(document.querySelectorAll(d),b.target),(f.call(b.target,d)||element)&&a.isFunction(e)&&e(b,element)},g.addEventListener(c,b.events[d][c],!1)},a.removeEvent=function(a,b,c){parent=a.$el,parent.removeEventListener(b,a.events[c][b])},a.removeAllEvent=function(a){},a.isChild=function(a,b){var c=!1;return a.forEach(function(a){return a.contains(b)?void(c=a):void 0}),c},a.toogleClass=function(a,b){var c=a.className,d=new RegExp("\\b"+b+"\\b"),e=c.match(d);b=b.replace(/\s+/g,""),e?a.className=c.replace(d,""):a.className=c+b}}(app),function(a){var b=function(b){b=b||{},this.data=b.data||{},this.localStorageKey=b.localStorageKey||void 0,this.dataArrayField=b.dataArrayField,a.listenerEvents.call(this),a.isFunction(b.init)&&b.init.call(this,b),this.localStorageKey&&this.restoreData()};a.extendClass(b,a.listenerEvents),b.prototype.getData=function(){return a.extend(!0,{},this.data)},b.prototype.setData=function(a,b,c,d){this.data[a]=b,c&&this.storeData(),d||this.on("model:set",this)},b.prototype.resetData=function(a,b){this.data=a,b||this.on("model:reset",this)},b.prototype.addItem=function(a,b,c,d){void 0==typeof this.data[a]&&(this.data[a]=[]),this.data[a].push(b),c&&this.storeData(),d||this.on("model:update",this)},b.prototype.append=function(a,b,c,d){void 0==typeof this.data[a]&&(this.data[a]=[]),this.data[a]=this.data[a].concat(b),c&&this.storeData(),d||this.on("model:update",this)},b.prototype.storeData=function(){this.getData()&&this.localStorageKey&&localStorage.setItem(this.localStorageKey,JSON.stringify(this.getData()))},b.prototype.restoreData=function(){var a;this.localStorageKey&&(a=localStorage.getItem(this.localStorageKey)),a?this.resetData(JSON.parse(a)):this.clearStorage()},b.prototype.clearStorage=function(){return localStorage.removeItem(this.localStorageKey)};var c=function(a){b.call(this,a),this.FBCredentials=a.data.FBCredentials};a.extendClass(c,b),c.prototype.connect=function(a){try{FB.init(this.FBCredentials)}catch(b){console.log(b)}},c.prototype.query=function(a,b,c,d,e,f){this.setData(this.dataArrayField,[],!0),this.queryCall(a,b,c,d,e,!0,f)},c.prototype.queryCall=function(b,c,d,e,f,g,h){var i=this;e||(e=10),FB.api("/search","GET",{q:b,type:c,fields:d,limit:e,after:g,access_token:this.FBCredentials.at},function(j){j.error?console.log(j.error):(i.append(i.dataArrayField,j.data,!0),a.isFunction(h)&&h.call(this,j),f&&(f-=1,g&&f>0&&j&&j.paging&&j.paging.cursors&&i.queryCall(b,c,d,e,f,j.paging.cursors.after)))})},c.prototype.find=function(b){var c=_.findWhere(this.data[this.dataArrayField],{id:b+""});return a.extend(!0,{},c)};var d=function(a){b.call(this,a)};a.extendClass(d,b),d.prototype.setData=void 0,d.prototype.find=function(a){if(void 0!==typeof this.data[this.dataArrayField])var b=_.findWhere(this.data[this.dataArrayField],{id:a+""});return b},d.prototype.indexOf=function(a){if(void 0!==typeof this.data[this.dataArrayField])var b=_.findIndex(this.data[this.dataArrayField],{id:a});return b},d.prototype.isFav=function(a){return this.indexOf(a)>=0?!0:!1},d.prototype.toggleItem=function(a,b,c){this.indexOf(a.id)>=0?this.removeItem(a):this.addItem(a,b,c)},d.prototype.addItem=function(a,b,c){var d=this.dataArrayField;"undefined"==typeof this.data[d]&&(this.data[d]=[]),this.data[d].push(a),b&&this.storeData(),c||this.on("model:update",this)},d.prototype.removeItem=function(a,b,c){var d=this.dataArrayField,e=this.indexOf(a.id);this.data[d].splice(e,1),b&&this.storeData(),c||this.on("model:remove",this,a)},a.Model=b,a.FBModel=c,a.FavouriteModel=d}(app),function(a){var b=function(b){b&&(a.listenerEvents.call(this),this.template=b.template||"",this.compiledTemplate=_.template(document.querySelector(this.template).innerHTML),this.region=b.region||"body",this.model=b.model||new a.Model,this.afterRender=b.afterRender,this.templateContext=b.templateContext,this.beforeRerender=b.beforeRerender,this.renderCount=0,this.$el=document.createElement("div"),document.querySelector(this.region).appendChild(this.$el),a.isFunction(b.init)&&b.init.call(this))};b.prototype=Object.create(a.listenerEvents.prototype),b.prototype.constructor=b,a.extendClass(b,a.listenerEvents),b.prototype.render=function(b){this.renderCount++,a.isFunction(this.beforeRerender)&&this.renderCount>1&&this.beforeRerender();var c=document.createElement("div");switch(c.innerHTML=this.compiledTemplate(a.extend(!0,this.model.getData(),this.templateContext)),this.beforeRender&&this.afterRender.call(this),b){case"append":this.$el.appendChild(c);break;case"prepend":this.$el.prependChild(c);break;case"replace":default:for(;this.$el.firstChild;)this.$el.removeChild(this.$el.firstChild);this.$el.appendChild(c)}this.afterRender&&this.afterRender.call(this)},a.View=b}(app),function(a){var b=function(b){this.options=b,this.model=b.model||new a.Model,this.primaryField=b.primaryField||"id",this.views={},this.options.emptyTemplate&&(this.compiledEmptyView=_.template(document.querySelector(this.options.emptyTemplate).innerHTML)),this.$region=document.querySelector(this.options.region);var c=this;this.model.listenTo("model:update",function(a,b){c.renderNewOnly()}),this.model.listenTo("model:reset",function(){c.render()}),this.model.listenTo("model:set",function(){c.render()}),this.model.listenTo("model:remove",function(a,b){c.removeOld(b.id)})};b.prototype.render=function(){var b=this;this.empty(),this.showEmptyView(),_.each(this.model.getData()[this.model.dataArrayField],function(c){var d={model:new a.Model({data:c})},e=new a.View(a.extend(!0,b.options,d));b.views[c[b.primaryField]]=e,e.render("append")})},b.prototype.renderNewOnly=function(){a.isEmptyObject(this.views)&&this.empty();var b=this;_.each(this.model.getData()[this.model.dataArrayField],function(c){if("object"!=typeof b.views[c[b.primaryField]]){var d={model:new a.Model({data:c})},e=new a.View(a.extend(!0,b.options,d));b.views[c[b.primaryField]]=e,e.render("append")}})},b.prototype.removeOld=function(a){var b=this;document.querySelector(this.options.region).removeChild(b.views[a].$el),delete b.views[a],this.showEmptyView()},b.prototype.showEmptyView=function(){0==this.model.getData()[this.model.dataArrayField].length&&this.compiledEmptyView&&(document.querySelector(this.options.region).innerHTML=this.compiledEmptyView())},b.prototype.empty=function(){for(var a=document.querySelectorAll(this.options.region)[0];a.firstChild;)a.removeChild(a.firstChild);0==this.model.getData()[this.model.dataArrayField].length&&(this.views={})},a.CollectionView=b}(app),function(a){!function(a){function b(){switch(a=window.location.hash){case"#searchArea":h.render(),document.querySelector("#favAreaWrapper").style.display="none",document.querySelector("#searchAreaWrapper").style.display="block",c("searchTab"),d();break;case"#favArea":i.render(),document.querySelector("#searchAreaWrapper").style.display="none",document.querySelector("#favAreaWrapper").style.display="block",c("favTab"),d()}}function c(a){var b=document.querySelector(".nav-wrapper ul li a.active");b.className=b.className.replace(new RegExp("active","g"),"");var b=document.querySelector(".nav-wrapper ul li#"+a+" a");b.className=b.className=b.className+" active"}function d(){var a=document.querySelector(".indicator"),b=document.querySelector(".nav-wrapper ul li a.active").parentElement,c=b.offsetLeft+"px",d=b.offsetWidth+"px";a.style.left=c,a.style.width=d}window.addEventListener("hashchange",b,!1)}();var b=new a.Model({localStorageKey:"search_data"}),c=new a.View({template:"#searchTemplate",region:"#searchTemplateContainer",model:b,afterRender:function(){var b=this;a.addEvent(this,"change","input#search",function(a){var c=a.target.value;b.model.setData("search",c,!0),f.query(c,"page","name, id, about, category, picture, fan_count, link, is_verified",20,5)})},beforeRerender:function(){a.removeEvent(this,"change","input#search")}});c.render();var d=new a.View({template:"#headerTemplate",region:"#headerWrapper",afterRender:function(){a.addEvent(this,"click","ul li.tab",function(a,b){})},beforeRerender:function(){a.removeEvent(this,"click","ul li.tab a")}});d.render();var e=new a.View({template:"#footerTemplate",region:"#footer-copyright"});e.render();var f=new a.FBModel({localStorageKey:"fb_data",dataArrayField:"queryData",data:{FBCredentials:{appId:"273738926370334",xfbml:!0,version:"v2.8",appSecret:"b276b4a0cd1a560461c7e089effc0554",at:"273738926370334|b276b4a0cd1a560461c7e089effc0554"}},init:function(a){}});window.fbAsyncInit=function(){f.connect(function(){})};var g=new a.FavouriteModel({localStorageKey:"favt_data",dataArrayField:"queryData",init:function(){}}),h=new a.CollectionView({template:"#cardTemplate",emptyTemplate:"#noDataAvailable",region:"#searchResult",model:f,templateContext:{colClass:"l2 m3 s12",getImagePath:function(a){return"https://graph.facebook.com/"+a+"/picture?type=normal"},isFav:function(a){return g.isFav(a)},showFav:function(){return!0}},afterRender:function(){var b=this;a.addEvent(this,"click",".favBtn",function(c,d){a.toogleClass(d,"white"),g.toggleItem(b.model.getData(),!0,!0)})},beforeRerender:function(){a.removeEvent(this,"click",".favBtn")}});h.render();var i=new a.CollectionView({template:"#cardTemplate",emptyTemplate:"#noDataAvailable",region:"#favResult",model:g,templateContext:{colClass:"l2 m3 s12",getImagePath:function(a){return"https://graph.facebook.com/"+a+"/picture?type=normal"},showFav:function(){return!1},isFav:function(a){return g.isFav(a)}},init:function(){this.listenTo("view:render",function(a){console.log("View Rendered.")})},afterRender:function(){var b=this;a.addEvent(this,"click",".cancelBtn",function(a,c){g.removeItem(b.model.getData(),!0)})},beforeRerender:function(){a.removeEvent(this,"click",".cancelBtn")}}),j=new Event("hashchange");window.dispatchEvent(j)}(app);